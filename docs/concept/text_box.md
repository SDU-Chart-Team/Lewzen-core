# 文本组件

## 文本矢量图类`TextBox`

使用组件坐标系的矢量图，是文本的装饰器

- 将文本映射到组件坐标系

- 文本框

  ```
  <svg>
  	<foriegnObject>
  		<div>...</div>
  	</foriegnObject>
  </svg>
  ```

  

### 成员

- 文本HTML `TextHTML`

  维护该文本框内文本（在前端）经过样式渲染后的HTML

  - 纯文本、LaTeX公式

- 坐标映射

  标记文本框在组件坐标系中的位置。通过记录文本框原点在组件坐标系中的位置，将文本框映射到组件坐标系中。

  考虑到一个组件中可以插入多个文本，同一个组件中每个文本矢量图的坐标原点应当彼此不同。

  - 成员

    组件相对坐标系原点

### 接口

- 创建过程

  - 坐标初始化

    接收文本框坐标

- 传入HTML

- 返回SVG

  返回由SVG标签嵌套（`<forignObject>`）的HTML语句

  - 基于组件布局实现对文本框的旋转等

- //检测坐标是否在文本外接矩形框内，从而选定文本并修改

- 坐标/布局更新

  当文本框坐标/组件布局修改时，接收新的文本框坐标/组件布局，重新生成文本SVG

## 文本框组件`TextEditor`

基于Vue的前端的文本编辑器

- 编辑、渲染文本

### 成员

- 文本源代码 `SourceCode`
- 文本样式表 
- 文本解析器 `TextParser`

### 接口

- 创建过程

  当创建一个新的文本框时，调用核心接口，新建一个`TextBox`对象，并传入文本框原点坐标坐标

- 获取到特定文本框
  
  当获取到画布上一个点的坐标时，判断是否处于某个文本框`TextBox`中；若是，获取到其内容HTML的字符串内容及样式并生成文本编辑器`TextEditor`
  
- 渲染

  当修改某个文本框内容或样式时，即时更新其HTML，从而实现即时渲染

  - 对于LaTeX公式，在修改完成后进行渲染

- 更新

  当修改文本框内容或样式完成后，调用核心`TextBox`对象接口，传入新的HTML，并获取到新的SVG

- 绘制

  映射到画布坐标系。
